BEGIN TRANSACTION;
CREATE TABLE IF NOT EXISTS `Rungtynes` (
	`Id`	TEXT,
	`Data`	TEXT,
	`Namai`	TEXT,
	`Isvyka`	TEXT,
	`Arena`	TEXT,
	`NamuTaskai`	TEXT,
	`IsvykosTaskai`	TEXT,
	`Lankomumas`	TEXT
);
INSERT INTO `Rungtynes` (Id,Data,Namai,Isvyka,Arena,NamuTaskai,IsvykosTaskai,Lankomumas) VALUES ('Id','Data','field4','field5','field6','field7','field8',NULL),
 ('5576','2018-11-18','Lietkabelis','Pieno žvaigždės','Cido arena','94','63','1246'),
 ('5575','2018-11-18','Žalgiris','Šiauliai','Žalgirio arena','102','61','2877'),
 ('5574','2018-11-18','Neptūnas','Rytas','Švyturio arena','78','93','5349'),
 ('5573','2018-11-18','Nevėžis','Dzūkija','Kėdainių arena','68','74','700'),
 ('5572','2018-11-17','Juventus','Skycop','Utenos daugiafunkcis sporto centras','78','67','1405'),
 ('5571','2018-11-12','Dzūkija','Žalgiris','Alytaus sporto ir rekreacijos centras','65','94','4217'),
 ('5570','2018-11-10','Skycop','Rytas','Prienų sporto arena','71','81','1250'),
 ('5569','2018-11-03','Juventus','Dzūkija','Utenos daugiafunkcis sporto centras','86','77','1383'),
 ('5565','2018-11-10','Šiauliai','Lietkabelis','Šiaulių arena','83','88','1700'),
 ('5564','2018-11-10','Nevėžis','Neptūnas','Kėdainių arena','69','83','600'),
 ('5563','2018-11-11','Pieno žvaigždės','Juventus','Pieno žvaigždžių arena','90','71','0'),
 ('5562','2018-11-04','Šiauliai','Žalgiris','Šiaulių arena','68','93','3800'),
 ('5561','2018-11-04','Skycop','Pieno žvaigždės','Prienų sporto arena','93','88','547'),
 ('5560','2018-11-03','Lietkabelis','Nevėžis','Cido arena','87','66','1240'),
 ('5559','2018-11-03','Rytas','Neptūnas','Siemens arena','66','78','3241'),
 ('5558','2018-10-28','Dzūkija','Skycop','Alytaus sporto ir rekreacijos centras','88','73','1557'),
 ('5557','2018-10-28','Žalgiris','Lietkabelis','Žalgirio arena','71','58','3663'),
 ('5556','2018-10-28','Juventus','Nevėžis','Utenos daugiafunkcis sporto centras','88','61','1235'),
 ('5555','2018-10-27','Šiauliai','Neptūnas','Šiaulių arena','88','98','1700'),
 ('5554','2018-10-27','Pieno žvaigždės','Rytas','Pieno žvaigždžių arena','78','89','500'),
 ('5553','2018-10-22','Žalgiris','Dzūkija','Žalgirio arena','88','75','2412'),
 ('5552','2018-10-21','Neptūnas','Juventus','Švyturio arena','81','70','2275'),
 ('5551','2018-10-21','Nevėžis','Skycop','Kėdainių arena','80','78','900'),
 ('5550','2018-10-20','Rytas','Šiauliai','Ryto arena','90','63','1475'),
 ('5549','2018-10-20','Pieno žvaigždės','Lietkabelis','Pieno žvaigždžių arena','87','81','550'),
 ('5548','2018-10-14','Lietkabelis','Šiauliai','Cido arena','79','73','1354'),
 ('5547','2018-10-14','Žalgiris','Neptūnas','Žalgirio arena','60','75','3324'),
 ('5546','2018-10-14','Nevėžis','Pieno žvaigždės','Kėdainių arena','80','86','600'),
 ('5545','2018-10-13','Dzūkija','Rytas','Alytaus sporto ir rekreacijos centras','73','79','1420'),
 ('5544','2018-10-13','Skycop','Juventus','Prienų sporto arena','85','80','886'),
 ('5543','2018-10-31','Dzūkija','Šiauliai','Alytaus sporto ir rekreacijos centras','91','81','1471'),
 ('5542','2018-10-07','Rytas','Žalgiris','Siemens arena','69','76','9751'),
 ('5541','2018-10-07','Lietkabelis','Juventus','Cido arena','81','77','1800'),
 ('5540','2018-10-07','Neptūnas','Skycop','Švyturio arena','92','67','1817'),
 ('5539','2018-10-06','Nevėžis','Šiauliai','Kėdainių arena','78','71','800'),
 ('5538','2018-10-06','Pieno žvaigždės','Dzūkija','Pieno žvaigždžių arena','60','74','250'),
 ('5537','2018-10-03','Juventus','Pieno žvaigždės','Utenos daugiafunkcis sporto centras','82','79','1226'),
 ('5536','2018-10-03','Žalgiris','Nevėžis','Kauno sporto halė','81','68','2125'),
 ('5535','2018-10-04','Dzūkija','Neptūnas','Alytaus sporto ir rekreacijos centras','91','94','1431'),
 ('5534','2018-10-03','Šiauliai','Skycop','Šiaulių arena','90','100','1800'),
 ('5533','2018-09-30','Neptūnas','Lietkabelis','Švyturio arena','76','89','3560'),
 ('5532','2018-09-30','Šiauliai','Pieno žvaigždės','Šiaulių arena','79','81','1500'),
 ('5531','2018-09-30','Juventus','Žalgiris','Utenos daugiafunkcis sporto centras','80','87','2214'),
 ('5530','2018-09-30','Rytas','Skycop','Ryto arena','95','66','2483'),
 ('5529','2018-09-29','Dzūkija','Nevėžis','Alytaus sporto ir rekreacijos centras','81','61','1031'),
 ('5528','2018-09-27','Skycop','Žalgiris','Prienų sporto arena','53','74','1500'),
 ('5527','2018-09-26','Nevėžis','Rytas','Kėdainių arena','70','80','1500'),
 ('5526','2018-09-26','Pieno žvaigždės','Neptūnas','Pieno žvaigždžių arena','69','88','500'),
 ('5525','2018-09-26','Juventus','Šiauliai','Utenos daugiafunkcis sporto centras','83','78','1156'),
 ('5524','2018-09-26','Lietkabelis','Dzūkija','Cido arena','71','69','1450'),
 ('5523','2018-09-23','Skycop','Lietkabelis','Prienų sporto arena','93','78','1150'),
 ('5522','2018-09-23','Rytas','Juventus','Ryto arena','87','57','2328'),
 ('5521','2018-09-23','Neptūnas','Nevėžis','Švyturio arena','100','76','3180'),
 ('5520','2018-09-22','Žalgiris','Pieno žvaigždės','Žalgirio arena','103','66','4315'),
 ('1179','2018-06-18','Žalgiris','Rytas','Žalgirio arena','80','70','10679'),
 ('1178','2018-06-17','Lietkabelis','Neptūnas','Cido arena','78','89','2718'),
 ('1177','2018-06-16','Rytas','Žalgiris','Siemens arena','78','82','7653'),
 ('1176','2018-06-15','Neptūnas','Lietkabelis','Švyturio arena','79','71','2800'),
 ('1175','2018-06-14','Žalgiris','Rytas','Žalgirio arena','90','80','8793'),
 ('1174','2018-06-12','Lietkabelis','Neptūnas','Cido arena','69','71','4215'),
 ('1173','2018-06-11','Rytas','Žalgiris','Siemens arena','82','73','7538'),
 ('1172','2018-06-10','Neptūnas','Lietkabelis','Švyturio arena','69','83','2100'),
 ('1171','2018-06-09','Žalgiris','Rytas','Žalgirio arena','96','83','6294'),
 ('1168','2018-06-03','Žalgiris','Lietkabelis','Žalgirio arena','83','64','2547'),
 ('1167','2018-05-31','Lietkabelis','Žalgiris','Cido arena','79','94','3542'),
 ('1166','2018-05-29','Žalgiris','Lietkabelis','Žalgirio arena','93','69','2722'),
 ('1165','2018-06-06','Rytas','Neptūnas','Siemens arena','88','82','5469'),
 ('1164','2018-06-04','Neptūnas','Rytas','Švyturio arena','74','70','4800'),
 ('1163','2018-06-02','Rytas','Neptūnas','Siemens arena','74','67','4089'),
 ('1162','2018-05-30','Neptūnas','Rytas','Švyturio arena','49','67','5200'),
 ('1161','2018-05-28','Rytas','Neptūnas','Siemens arena','79','84','3857'),
 ('650','2018-05-22','Šiauliai','Lietkabelis','Šiaulių arena','84','85','2500'),
 ('649','2018-05-25','Žalgiris','Nevėžis','Žalgirio arena','84','69','1862'),
 ('648','2018-05-22','Pieno žvaigždės','Neptūnas','Pieno žvaigždžių arena','64','101','500'),
 ('646','2018-05-19','Lietkabelis','Šiauliai','Cido arena','92','68','2659'),
 ('645','2018-05-19','Neptūnas','Pieno žvaigždės','Švyturio arena','92','82','2100'),
 ('644','2018-05-19','Rytas','Juventus','Siemens arena','102','73','2900'),
 ('643','2018-05-15','Šiauliai','Lietkabelis','Šiaulių arena','94','84','3200'),
 ('642','2018-05-14','Pieno žvaigždės','Neptūnas','Pieno žvaigždžių arena','92','87','500'),
 ('641','2018-05-14','Juventus','Rytas','Utenos daugiafunkcis sporto centras','78','79','1420'),
 ('640','2018-05-24','Nevėžis','Žalgiris','Kėdainių arena','75','96','1800'),
 ('639','2018-05-12','Lietkabelis','Šiauliai','Cido arena','103','86','2711'),
 ('638','2018-05-12','Žalgiris','Nevėžis','Žalgirio arena','95','70','1374'),
 ('637','2018-05-11','Neptūnas','Pieno žvaigždės','Švyturio arena','91','81','2100'),
 ('636','2018-05-11','Rytas','Juventus','Siemens arena','97','64','3052'),
 ('180','2018-05-02','Rytas','Nevėžis','Ryto arena','97','77','973'),
 ('179','2018-05-03','Juventus','Šiauliai','Utenos daugiafunkcis sporto centras','93','90','1009'),
 ('178','2018-04-29','Dzūkija','Juventus','Alytaus sporto ir rekreacijos centras','68','73','817'),
 ('177','2018-05-02','Lietkabelis','Žalgiris','Cido arena','74','81','4517'),
 ('176','2018-05-03','Neptūnas','Dzūkija','Švyturio arena','90','86','2200'),
 ('175','2018-05-02','Pieno žvaigždės','Skycop','Pieno žvaigždžių arena','79','73','300'),
 ('174','2018-04-29','Šiauliai','Lietkabelis','Šiaulių arena','87','65','2500'),
 ('173','2018-04-26','Dzūkija','Pieno žvaigždės','Alytaus sporto ir rekreacijos centras','103','85','858'),
 ('172','2018-04-26','Lietkabelis','Rytas','Cido arena','83','104','2912'),
 ('171','2018-04-29','Rytas','Pieno žvaigždės','Ryto arena','110','68','1100'),
 ('170','2018-04-28','Skycop','Neptūnas','Prienų sporto arena','76','89','520'),
 ('169','2018-04-29','Žalgiris','Nevėžis','Kauno sporto halė','91','72','2574'),
 ('168','2018-04-25','Skycop','Šiauliai','Prienų sporto arena','69','73','800'),
 ('167','2018-04-25','Nevėžis','Neptūnas','Kėdainių arena','74','67','800'),
 ('166','2018-05-07','Žalgiris','Juventus','Žalgirio arena','82','56','1884'),
 ('165','2018-04-22','Neptūnas','Rytas','Švyturio arena','72','90','5300'),
 ('164','2018-05-09','Žalgiris','Skycop','Žalgirio arena','109','52','1826'),
 ('163','2018-04-22','Nevėžis','Juventus','Kėdainių arena','102','89','1000'),
 ('162','2018-04-21','Dzūkija','Šiauliai','Alytaus sporto ir rekreacijos centras','99','107','1052'),
 ('161','2018-04-21','Pieno žvaigždės','Lietkabelis','Pieno žvaigždžių arena','85','94','1100'),
 ('160','2018-04-19','Juventus','Skycop','Utenos daugiafunkcis sporto centras','67','80','1525'),
 ('159','2018-04-18','Rytas','Šiauliai','Ryto arena','87','75','1470'),
 ('158','2018-04-18','Lietkabelis','Neptūnas','Cido arena','89','94','3317'),
 ('157','2018-04-18','Nevėžis','Dzūkija','Kėdainių arena','87','78','1300'),
 ('156','2018-05-05','Pieno žvaigždės','Žalgiris','Pieno žvaigždžių arena','76','85','1100'),
 ('155','2018-04-13','Žalgiris','Rytas','Žalgirio arena','77','66','10585'),
 ('154','2018-04-15','Juventus','Pieno žvaigždės','Utenos daugiafunkcis sporto centras','82','93','1242'),
 ('153','2018-04-15','Skycop','Dzūkija','Prienų sporto arena','74','63','800'),
 ('152','2018-04-14','Nevėžis','Lietkabelis','Kėdainių arena','99','87','650'),
 ('151','2018-04-14','Šiauliai','Neptūnas','Šiaulių arena','77','76','2300'),
 ('150','2018-04-10','Rytas','Juventus','Ryto arena','78','75','1340'),
 ('149','2018-04-12','Nevėžis','Skycop','Kėdainių arena','79','96','1301'),
 ('148','2018-04-10','Žalgiris','Neptūnas','Žalgirio arena','94','47','3311'),
 ('147','2018-04-11','Lietkabelis','Dzūkija','Cido arena','95','64','3211'),
 ('146','2018-04-11','Pieno žvaigždės','Šiauliai','Pieno žvaigždžių arena','84','81','500'),
 ('145','2018-04-08','Dzūkija','Žalgiris','Alytaus sporto ir rekreacijos centras','60','82','3692'),
 ('144','2018-04-07','Rytas','Skycop','Ryto arena','104','71','1950'),
 ('143','2018-04-08','Šiauliai','Nevėžis','Šiaulių arena','90','73','1000'),
 ('142','2018-04-07','Juventus','Lietkabelis','Utenos daugiafunkcis sporto centras','105','95','1356'),
 ('141','2018-04-07','Neptūnas','Pieno žvaigždės','Švyturio arena','90','71','2500'),
 ('140','2018-04-02','Šiauliai','Žalgiris','Šiaulių arena','93','90','5200'),
 ('139','2018-04-02','Nevėžis','Pieno žvaigždės','Kėdainių arena','77','61','700'),
 ('138','2018-03-31','Dzūkija','Rytas','Alytaus sporto ir rekreacijos centras','73','81','3217'),
 ('137','2018-03-31','Neptūnas','Juventus','Švyturio arena','87','91','3400'),
 ('136','2018-03-31','Skycop','Lietkabelis','Prienų sporto arena','76','91','1000'),
 ('135','2018-03-25','Žalgiris','Lietkabelis','Žalgirio arena','85','72','3712'),
 ('134','2018-03-25','Skycop','Nevėžis','Prienų sporto arena','77','90','800'),
 ('133','2018-03-24','Juventus','Neptūnas','Utenos daugiafunkcis sporto centras','81','90','1469'),
 ('132','2018-03-24','Šiauliai','Rytas','Šiaulių arena','74','84','3000'),
 ('131','2018-03-24','Pieno žvaigždės','Dzūkija','Pieno žvaigždžių arena','73','72','450'),
 ('130','2018-03-19','Dzūkija','Skycop','Alytaus sporto ir rekreacijos centras','82','79','2896'),
 ('129','2018-03-17','Lietkabelis','Juventus','Cido arena','88','83','3011'),
 ('128','2018-03-18','Rytas','Neptūnas','Siemens arena','86','99','7180'),
 ('127','2018-03-17','Žalgiris','Šiauliai','Žalgirio arena','69','58','2677'),
 ('126','2018-03-17','Pieno žvaigždės','Nevėžis','Pieno žvaigždžių arena','87','84','600'),
 ('125','2018-03-12','Nevėžis','Žalgiris','Kėdainių arena','73','79','1200'),
 ('124','2018-03-11','Dzūkija','Lietkabelis','Alytaus sporto ir rekreacijos centras','98','73','2664'),
 ('123','2018-03-10','Šiauliai','Pieno žvaigždės','Šiaulių arena','100','79','2500'),
 ('122','2018-03-10','Juventus','Rytas','Utenos daugiafunkcis sporto centras','92','104','2269'),
 ('121','2018-03-10','Neptūnas','Skycop','Švyturio arena','73','65','5100'),
 ('120','2018-03-04','Lietkabelis','Pieno žvaigždės','Cido arena','95','85','3017'),
 ('119','2018-03-04','Šiauliai','Juventus','Šiaulių arena','120','84','1700'),
 ('118','2018-03-04','Žalgiris','Dzūkija','Žalgirio arena','72','63','2423'),
 ('117','2018-03-04','Neptūnas','Nevėžis','Švyturio arena','81','64','3000'),
 ('116','2018-03-03','Skycop','Rytas','Prienų sporto arena','76','83','1200'),
 ('115','2018-03-01','Neptūnas','Šiauliai','Švyturio arena','71','78','2500'),
 ('114','2018-02-11','Rytas','Žalgiris','Siemens arena','75','68','9830'),
 ('113','2018-02-11','Šiauliai','Skycop','Šiaulių arena','95','97','3800'),
 ('112','2018-02-10','Lietkabelis','Nevėžis','Cido arena','82','72','2953'),
 ('111','2018-02-10','Dzūkija','Neptūnas','Alytaus sporto ir rekreacijos centras','63','81','1331'),
 ('110','2018-02-10','Pieno žvaigždės','Juventus','Pieno žvaigždžių arena','75','63','650'),
 ('109','2018-02-07','Šiauliai','Dzūkija','Šiaulių arena','86','76','1500'),
 ('108','2018-02-04','Skycop','Žalgiris','Prienų sporto arena','96','118','1500'),
 ('107','2018-02-04','Juventus','Dzūkija','Utenos daugiafunkcis sporto centras','75','79','951'),
 ('106','2018-02-03','Lietkabelis','Šiauliai','Cido arena','94','83','2713'),
 ('105','2018-02-03','Pieno žvaigždės','Neptūnas','Pieno žvaigždžių arena','87','83','803'),
 ('104','2018-02-03','Nevėžis','Rytas','Kėdainių arena','73','83','970'),
 ('103','2018-01-28','Žalgiris','Pieno žvaigždės','Kauno sporto halė','91','80','3200'),
 ('102','2018-01-28','Nevėžis','Šiauliai','Kėdainių arena','70','67','1000'),
 ('101','2018-01-27','Neptūnas','Lietkabelis','Švyturio arena','83','78','4200'),
 ('100','2018-01-27','Rytas','Dzūkija','Ryto arena','105','84','830'),
 ('99','2018-01-27','Skycop','Juventus','Prienų sporto arena','78','86','1150'),
 ('98','2018-01-21','Neptūnas','Žalgiris','Švyturio arena','75','83','5490'),
 ('97','2018-01-21','Skycop','Pieno žvaigždės','Prienų sporto arena','93','116','1100'),
 ('96','2018-01-20','Rytas','Lietkabelis','Siemens arena','96','67','6820'),
 ('95','2018-01-20','Juventus','Nevėžis','Utenos daugiafunkcis sporto centras','110','81','942'),
 ('94','2018-01-14','Dzūkija','Nevėžis','Alytaus sporto ir rekreacijos centras','80','84','1238'),
 ('93','2018-01-14','Juventus','Žalgiris','Utenos daugiafunkcis sporto centras','79','81','2369'),
 ('92','2018-01-13','Lietkabelis','Skycop','Cido arena','95','86','4819'),
 ('91','2018-01-13','Pieno žvaigždės','Rytas','Pieno žvaigždžių arena','65','93','1100'),
 ('90','2018-01-07','Pieno žvaigždės','Juventus','Pieno žvaigždžių arena','81','93','1050'),
 ('89','2018-01-07','Žalgiris','Nevėžis','Žalgirio arena','94','68','2934'),
 ('88','2018-01-06','Lietkabelis','Dzūkija','Cido arena','98','87','2712'),
 ('87','2018-01-06','Rytas','Skycop','Ryto arena','113','56','2550'),
 ('86','2018-01-04','Neptūnas','Šiauliai','Švyturio arena','84','79','3400'),
 ('85','2018-01-02','Šiauliai','Skycop','Šiaulių arena','79','73','2000'),
 ('84','2018-01-02','Lietkabelis','Pieno žvaigždės','Cido arena','100','91','3002'),
 ('83','2017-12-30','Dzūkija','Rytas','Alytaus sporto ir rekreacijos centras','74','85','3764'),
 ('82','2017-12-30','Juventus','Žalgiris','Utenos daugiafunkcis sporto centras','74','78','3128'),
 ('81','2017-12-28','Nevėžis','Šiauliai','Kėdainių arena','72','79','670'),
 ('80','2017-12-27','Neptūnas','Skycop','Švyturio arena','104','83','4300'),
 ('79','2017-12-23','Žalgiris','Dzūkija','Žalgirio arena','72','60','2310'),
 ('78','2017-12-23','Lietkabelis','Rytas','Cido arena','69','75','5969'),
 ('77','2017-12-23','Nevėžis','Juventus','Kėdainių arena','74','78','640'),
 ('76','2017-12-23','Pieno žvaigždės','Neptūnas','Pieno žvaigždžių arena','86','92','600'),
 ('75','2017-12-18','Dzūkija','Pieno žvaigždės','Alytaus sporto ir rekreacijos centras','85','76','1105'),
 ('74','2017-12-17','Rytas','Šiauliai','Ryto arena','103','98','1970'),
 ('73','2017-12-17','Juventus','Lietkabelis','Utenos daugiafunkcis sporto centras','91','71','1569'),
 ('72','2017-12-16','Nevėžis','Neptūnas','Kėdainių arena','74','85','850');
CREATE TABLE IF NOT EXISTS `Komandos` (
	`Id`	INTEGER,
	`Komanda`	INTEGER
);
INSERT INTO `Komandos` (Id,Komanda) VALUES (1,'Rytas'),
 (2,'Zalgiris'),
 (3,'Prienai'),
 (4,'Neptunas'),
 (5,'Siauliai'),
 (6,'Lietkabelis'),
 (7,'Nevezis'),
 (8,'Alytus'),
 (9,'Pasvalys'),
 (10,'Utena');
COMMIT;


drop view rungtynes_v;
create view rungtynes_v as 
select r.id,
	   r.namai,
	   (select komanda from komandos where id = r.namai) NamaiName,
	   r.isvyka,	   
	   (select komanda from komandos where id = r.isvyka) IsvykaName,
	   r.NamuTaskai,
	   r.IsvykosTaskai,
	   (select AllTimeEff from komandos where id = r.namai) NamaiEff,
	   (select AllTimeEff from komandos where id = r.isvyka) IsvykaEff,
	   r.data,
	   (select count(*) from rungtynes r2 where r2.namai = r.namai and r2.NamuTaskai > r2.IsvykosTaskai and julianday(r2.data) - julianday(r.data) > 0) HomeWins,
	   (select count(*) from rungtynes r2 where r2.isvyka = r.isvyka and r2.NamuTaskai < r2.IsvykosTaskai and julianday(r2.data) - julianday(r.data) > 0) AwayWins,
	   (select count(*) from rungtynes r2 where r2.namai = r.namai and r2.NamuTaskai > r2.IsvykosTaskai and julianday(r2.data) - julianday(r.data) > 0) + 
	   (select count(*) from rungtynes r2 where r2.isvyka = r.namai and r2.NamuTaskai < r2.IsvykosTaskai and julianday(r2.data) - julianday(r.data) > 0) HomeTotalWins,
	   (select count(*) from rungtynes r2 where r2.namai = r.isvyka and r2.NamuTaskai > r2.IsvykosTaskai and julianday(r2.data) - julianday(r.data) > 0) + 
	   (select count(*) from rungtynes r2 where r2.isvyka = r.isvyka and r2.NamuTaskai < r2.IsvykosTaskai and julianday(r2.data) - julianday(r.data) > 0) AwayTotalWins,
	   (select count(*) from rungtynes r2 where r2.namai = r.namai and r2.isvyka = r.isvyka and r2.NamuTaskai > r2.IsvykosTaskai and julianday(r2.data) - julianday(r.data) > 0) + 
	   (select count(*) from rungtynes r2 where r2.isvyka = r.namai and r2.namai = r.isvyka and r2.NamuTaskai < r2.IsvykosTaskai and julianday(r2.data) - julianday(r.data) > 0)  HomeEnemyWins,
	   (select count(*) from rungtynes r2 where r2.namai = r.namai and r2.isvyka = r.isvyka and r2.NamuTaskai < r2.IsvykosTaskai and julianday(r2.data) - julianday(r.data) > 0) + 
	   (select count(*) from rungtynes r2 where r2.isvyka = r.namai and r2.namai = r.isvyka and r2.NamuTaskai > r2.IsvykosTaskai and julianday(r2.data) - julianday(r.data) > 0)  AwayEnemyWins,
	   (select count(*) from rungtynes r2 where r2.id = r.id and r2.NamuTaskai > r2.IsvykosTaskai) Iseitis
	   from Rungtynes r where julianday(r.data) - julianday('2018-05-01') > 0
	   order by r.namai;
		
	   select * from rungtynes_v;
	   select * from rungtynes_v_test;
	   
	   select julianday('2018-05-30')
	   
	   SELECT NamaiEff as Ne,
                    IsvykaEff as Ie,
                    HomeWins as Hw,
                    AwayWins as Aw,
                    HomeTotalWins as Htw,
                    AwayTotalWins as Atw,
                    HomeEnemyWins as Hew,
                    AwayEnemyWins as Aew,
                    Output as output
             FROM rungtynes_v